<!DOCTYPE html>
<html>
    <head>
        <script>
            function computerPlay() {
                const weapons = ["rock", "paper", "scissors"];
                return weapons[Math.floor(Math.random() * 3)];
            }

            function handleInputs(message) {
                const playerSelectionInput = prompt(message);
                const playerSelection = playerSelectionInput.toLowerCase();
                let computerSelection = computerPlay();
                return [playerSelection, computerSelection];
            }

            function playRound(playerSelection, computerSelection) {
                playerSelection = playerSelection.toLowerCase();
                while (playerSelection === computerSelection) {
                    [playerSelection, computerSelection] = handleInputs(`It\'s a draw: ${playerSelection} matches ${computerSelection}! Replay the round!`)
                }
                let isWin;
                switch(playerSelection + computerSelection) {
                    case "paperscissors":
                    case "rockpaper":
                    case "scissorsrock":
                        isWin = false;
                        break;
                    case "rockscissors":
                    case "paperrock":
                    case "scissorspaper":
                        isWin = true;
                        break;
                }
                return isWin ? `You win, ${playerSelection} beats ${computerSelection}!` : `You lose, ${computerSelection} beats ${playerSelection}!`;
            }

            function game() {
                let score = 0;
                for (i=0; i<5; i++) {
                    let playerSelection = prompt(`Round ${i+1}\nChoose your weapon:`);
                    let computerSelection = computerPlay();
                    console.log(computerSelection);
                    let round = playRound(playerSelection, computerSelection);
                    console.log(round);
                    round.includes("win") && score++;
                }
                outcomeMessage = score > 2 ? "You win!" : "You lose!";
                console.log(outcomeMessage + "\nScore: " + score);
            }

        </script>
    </head>
</html>