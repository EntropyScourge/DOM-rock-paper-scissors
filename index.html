<!DOCTYPE html>
<html>
    <head>
        <script>
            function computerPlay() {
                const weapons = ["rock", "paper", "scissors"];
                return weapons[Math.floor(Math.random() * 3)];
            }

            function handleInputs(message) {
                const playerSelection = prompt(message).toLowerCase();
                const computerSelection = computerPlay();
                return [playerSelection, computerSelection];
            }

            function playRound(playerSelection, computerSelection) {
                playerSelection = playerSelection.toLowerCase();
                while (playerSelection === computerSelection) {
                    [playerSelection, computerSelection] = handleInputs(`It\'s a draw: ${playerSelection} matches ${computerSelection}! Replay the round!`)
                }
                let win;
                switch(playerSelection + computerSelection) {
                    case "paperscissors":
                    case "rockpaper":
                    case "scissorsrock":
                        win = false;
                        break;
                    case "rockscissors":
                    case "paperrock":
                    case "scissorspaper":
                        win = true;
                        break;
                }
                return win ? `You win, ${playerSelection} beats ${computerSelection}!` : `You lose, ${computerSelection} beats ${playerSelection}!`;
            }

            function game() {
                let score = 0;
                for (i=0; i<5; i++) {
                    const inputs = handleInputs(`Round ${i+1}\nChoose your weapon:`)
                    let round = playRound(inputs[0], inputs[1]);
                    console.log("Round " + (i+1) + ": " + round);
                    round.includes("win") && score++;
                }
                outcomeMessage = score > 2 ? "You win!" : "You lose!";
                console.log(outcomeMessage + "\nScore: " + score + "/5");
            }

        </script>
    </head>
</html>